<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Budget Shark</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2245%22 fill=%22%23A9DEF9%22/><circle cx=%2235%22 cy=%2240%22 r=%225%22 fill=%22black%22/><circle cx=%2265%22 cy=%2240%22 r=%225%22 fill=%22black%22/><path d=%22M45 60 Q50 65 55 60%22 stroke=%22black%22 fill=%22none%22 stroke-width=%222%22/></svg>">
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Pacifico&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Material 3 Dark Theme */
            --md-sys-color-background: #141218;
            --md-sys-color-surface: #1D1B20;
            --md-sys-color-primary: #D0BCFF;
            --md-sys-color-on-primary: #381E72;
            --md-sys-color-secondary-container: #4A4458;
            --md-sys-color-on-secondary-container: #E8DEF8;
            --md-sys-color-outline: #938F99;
            --md-sys-color-on-surface: #E6E1E5;
            --md-sys-color-on-surface-variant: #CAC4D0;
            --md-sys-color-error: #F2B8B5;
            --md-sys-color-success: #B6F397;
            --md-sys-color-on-success: #133907;
            --radius-xl: 28px;
            --radius-pill: 50px;
        }

        body {
            background-color: var(--md-sys-color-background);
            color: var(--md-sys-color-on-surface);
            font-family: 'Roboto', sans-serif;
            margin: 0; padding: 20px;
            display: flex; justify-content: center;
            min-height: 100vh; overflow-x: hidden;
        }

        .app-container { width: 100%; max-width: 420px; display: flex; flex-direction: column; gap: 20px; position: relative; z-index: 10; }

        header { text-align: center; }
        h1 { font-family: 'Pacifico', cursive; font-size: 32px; color: var(--md-sys-color-primary); margin: 0; }

        /* Navigation */
        .segmented-control {
            background: var(--md-sys-color-surface);
            border: 1px solid var(--md-sys-color-outline);
            border-radius: var(--radius-pill);
            display: flex; position: relative; height: 52px; margin-top: 16px; overflow: hidden;
        }
        .segmented-control input { display: none; }
        .segmented-control label { flex: 1; z-index: 2; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 500; cursor: pointer; }
        .selection-indicator {
            position: absolute; height: 100%; width: 33.33%;
            background-color: var(--md-sys-color-primary);
            border-radius: var(--radius-pill); top: 0; left: 0;
            transition: transform 0.4s cubic-bezier(0.2, 0, 0, 1); z-index: 1;
        }
        #tab-1:checked ~ .selection-indicator { transform: translateX(0%); }
        #tab-2:checked ~ .selection-indicator { transform: translateX(100%); }
        #tab-3:checked ~ .selection-indicator { transform: translateX(200%); }

        /* Hero Section */
        .hero-card {
            background: linear-gradient(135deg, #2b2930 0%, #1D1B20 100%);
            border-radius: var(--radius-xl); padding: 24px;
            border: 1px solid rgba(255,255,255,0.05);
            display: flex; flex-direction: column; gap: 12px;
        }
        .hero-row { display: flex; justify-content: space-between; align-items: center; }
        .hero-label { font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; color: var(--md-sys-color-on-surface-variant); }
        .hero-amount { font-size: 32px; font-weight: 700; color: var(--md-sys-color-primary); margin: 0; }
        
        /* Cards & Inputs */
        .card { background-color: var(--md-sys-color-surface); border-radius: var(--radius-xl); padding: 20px; display: flex; flex-direction: column; gap: 16px; }
        .pill { padding: 4px 12px; border-radius: var(--radius-pill); font-size: 11px; font-weight: 700; text-transform: uppercase; }
        .pill.red { background-color: var(--md-sys-color-error); color: #601410; }
        .pill.green { background-color: var(--md-sys-color-success); color: #133907; }
        .pill.neutral { background-color: var(--md-sys-color-secondary-container); color: var(--md-sys-color-on-secondary-container); }

        input[type=range] { -webkit-appearance: none; width: 100%; height: 44px; background: transparent; cursor: pointer; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 24px; border-radius: var(--radius-pill); background: #35323a; }
        input[type=range]::-webkit-slider-thumb { height: 32px; width: 32px; border-radius: 50%; background: #ffffff; -webkit-appearance: none; margin-top: -4px; box-shadow: 0 4px 8px rgba(0,0,0,0.3); }

        .progress-card { background-color: var(--md-sys-color-secondary-container); border-radius: var(--radius-xl); padding: 24px; }
        .progress-bar-bg { width: 100%; height: 12px; background: rgba(0,0,0,0.2); border-radius: 6px; overflow: hidden; margin: 8px 0; }
        .progress-bar-fill { height: 100%; background: var(--md-sys-color-primary); width: 0%; transition: width 0.5s ease; }

        .tiny-input { background: rgba(255,255,255,0.08); border: 1px solid var(--md-sys-color-outline); color: white; border-radius: 12px; padding: 8px; width: 90px; text-align: center; outline: none; }
        .reset-btn { background-color: var(--md-sys-color-primary); color: var(--md-sys-color-on-primary); border: none; padding: 16px; border-radius: var(--radius-pill); font-weight: 700; cursor: pointer; margin-top: 10px; width: 100%; }

        /* --- CELEBRATION --- */
        #celebration-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(20, 18, 24, 0.98);
            z-index: 1000; display: none; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
        }
        .bubbly-text { font-family: 'Pacifico', cursive; color: #FF99CC; font-size: 42px; margin: 0; text-shadow: 3px 3px 0px #fff; animation: bounce 1s infinite; }
        .love-text { color: #D0BCFF; font-size: 20px; font-weight: 700; margin-top: 10px; opacity: 0.9; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        
        /* The Round Shark SVG Styling */
        .shark-svg { position: absolute; animation: swim 8s linear infinite; bottom: 25%; z-index: 1001; }
        @keyframes swim {
            0% { left: -150px; transform: scaleX(1) translateY(0); }
            50% { transform: scaleX(1) translateY(-40px); }
            100% { left: 110%; transform: scaleX(1) translateY(0); }
        }
        .bubble { position: absolute; bottom: -50px; background: rgba(173, 216, 230, 0.4); border-radius: 50%; animation: rise 4s infinite ease-in; }
        @keyframes rise { to { transform: translateY(-110vh); opacity: 0; } }
    </style>
</head>
<body>

<div id="celebration-overlay">
    <div class="shark-svg">
        <svg width="140" height="100" viewBox="0 0 140 100" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M20 50L5 35V65L20 50Z" fill="#A9DEF9"/>
            <path d="M70 70L60 85L55 70H70Z" fill="#A9DEF9"/>
            <path d="M70 30L60 15L55 30H70Z" fill="#A9DEF9"/>
            <ellipse cx="75" cy="50" rx="55" ry="40" fill="#A9DEF9"/>
            <ellipse cx="75" cy="65" rx="35" ry="15" fill="white" fill-opacity="0.4"/>
            <path d="M75 20L90 0L100 20H75Z" fill="#A9DEF9"/>
            <circle cx="105" cy="40" r="7" fill="black"/>
            <circle cx="107" cy="37" r="2.5" fill="white"/> <circle cx="125" cy="40" r="7" fill="black"/>
            <circle cx="127" cy="37" r="2.5" fill="white"/> <path d="M110 55C113 58 117 58 120 55" stroke="black" stroke-width="2" stroke-linecap="round"/>
        </svg>
    </div>

    <h1 class="bubbly-text">I KNEW YOU<br>COULD DO IT!</h1>
    <p class="love-text">I LOVE YOU, MEG!! ❤️</p>
    <button class="reset-btn" style="width: 200px; margin-top: 40px;" onclick="document.getElementById('celebration-overlay').style.display='none'">Go Back</button>
</div>

<div class="app-container">
    <header>
        <h1>Budget Shark</h1>
        <div class="segmented-control">
            <input type="radio" name="v" id="tab-1" checked onchange="switchTab('p1')"><label for="tab-1">Paycheck 1</label>
            <input type="radio" name="v" id="tab-2" onchange="switchTab('p2')"><label for="tab-2">Paycheck 2</label>
            <input type="radio" name="v" id="tab-3" onchange="switchTab('monthly')"><label for="tab-3">Month</label>
            <div class="selection-indicator"></div>
        </div>
    </header>

    <div class="hero-card">
        <div class="hero-row">
            <div><span class="hero-label">Target Savings</span><p class="hero-amount" id="target-savings-display">$0</p></div>
            <div style="text-align: right;"><span class="hero-label">Actual Saved</span><br><input type="number" id="actual-savings-input" class="tiny-input" oninput="updateActualSavings(this.value)"></div>
        </div>
        <div id="savings-performance-pill" class="pill neutral" style="align-self: flex-start;">No Data</div>
    </div>

    <div class="card" style="padding: 16px 24px;"><div style="display: flex; justify-content: space-between; align-items: center;"><span class="card-title">Paycheck Income</span><input type="number" id="income-input" class="tiny-input" oninput="updateIncome(this.value)"></div></div>
    
    <div id="category-container" style="display: flex; flex-direction: column; gap: 16px;"></div>

    <div class="progress-card">
        <div style="display: flex; justify-content: space-between; align-items: center;"><span class="card-title" style="color:var(--md-sys-color-on-secondary-container)">Savings Goal Progress</span><div style="font-size: 11px; opacity: 0.8; text-align: right;">Banked Total:<br><input type="number" id="base-savings" class="tiny-input" style="width:80px; margin-top:4px;" oninput="updateBase(this.value)"></div></div>
        <div class="progress-bar-bg"><div id="goal-progress-fill" class="progress-bar-fill"></div></div>
        <div class="progress-stats"><span id="total-saved-label">$0</span><span>Goal: $5,000</span></div>
        <button id="reset-month-btn" class="reset-btn" style="display:none;" onclick="endMonthReset()">Close Month & Bank Actuals</button>
    </div>
</div>

<script>
    const defaultState = { currentTab: 'p1', baseSavings: 0, p1: { income: 1122, actualSavings: 0, expenses: getDefaults() }, p2: { income: 1122, actualSavings: 0, expenses: getDefaults() } };
    function getDefaults() { return { 'tithe': { label: 'Tithe', val: 100, max: 300, goal: 100, type: 'giving' }, 'rent': { label: 'Rent', val: 200, max: 400, goal: 200, type: 'bill' }, 'insur': { label: 'Insurance', val: 280, max: 400, goal: 280, type: 'bill' }, 'gas': { label: 'Gas', val: 45, max: 150, goal: 45, type: 'variable' }, 'spend': { label: 'Spending', val: 100, max: 300, goal: 100, type: 'variable' } }; }
    
    let state = {};
    let hasCelebrated = false;

    function init() {
        const saved = localStorage.getItem('budgetShark_V1');
        state = saved ? JSON.parse(saved) : JSON.parse(JSON.stringify(defaultState));
        document.getElementById('base-savings').value = state.baseSavings;
        render();
    }

    function switchTab(t) { state.currentTab = t; render(); }
    function updateIncome(v) { if(state.currentTab !== 'monthly'){ state[state.currentTab].income = parseFloat(v)||0; save(); calculateFinals(); }}
    function updateBase(v) { state.baseSavings = parseFloat(v)||0; save(); calculateFinals(); }
    function updateActualSavings(v) { if(state.currentTab !== 'monthly'){ state[state.currentTab].actualSavings = parseFloat(v)||0; save(); calculateFinals(); }}
    
    function updateExp(key, v) {
        state[state.currentTab].expenses[key].val = parseFloat(v)||0;
        document.getElementById(`amt-${key}`).innerText = "$" + Math.round(v);
        const diff = v - state[state.currentTab].expenses[key].goal;
        const p = document.getElementById(`pill-${key}`);
        p.className = `pill ${diff > 0 ? 'red' : (diff < 0 ? 'green' : 'neutral')}`;
        p.innerText = diff === 0 ? "Target Met" : (diff > 0 ? `+$${Math.round(diff)} Over` : `-$${Math.round(Math.abs(diff))} Under`);
        updateSliderFill(document.getElementById(`slider-${key}`), state[state.currentTab].expenses[key].type);
        save(); calculateFinals();
    }

    function calculateFinals() {
        const p1Exp = Object.values(state.p1.expenses).reduce((a, b) => a + b.val, 0);
        const p2Exp = Object.values(state.p2.expenses).reduce((a, b) => a + b.val, 0);
        const p1T = state.p1.income - p1Exp; const p2T = state.p2.income - p2Exp;
        
        let target = state.currentTab === 'monthly' ? (p1T + p2T) : (state.currentTab === 'p1' ? p1T : p2T);
        let actual = state.currentTab === 'monthly' ? (state.p1.actualSavings + state.p2.actualSavings) : state[state.currentTab].actualSavings;
        
        document.getElementById('target-savings-display').innerText = "$" + Math.round(target);
        document.getElementById('actual-savings-input').value = (state.currentTab === 'monthly') ? actual : (actual || "");
        document.getElementById('actual-savings-input').disabled = (state.currentTab === 'monthly');

        const diff = actual - target;
        const p = document.getElementById('savings-performance-pill');
        if (actual === 0 && target > 0) { p.innerText = "Pending Deposit"; p.className = "pill neutral"; }
        else { p.innerText = diff >= 0 ? (diff === 0 ? "Goal Met" : `+$${Math.round(diff)} Saved`) : `-$${Math.round(Math.abs(diff))} Short`; p.className = `pill ${diff >= 0 ? 'green' : 'red'}`; }

        const totalOverall = state.baseSavings + (state.p1.actualSavings + state.p2.actualSavings);
        document.getElementById('total-saved-label').innerText = "$" + Math.round(totalOverall) + " saved";
        const percent = Math.min((totalOverall / 5000) * 100, 100);
        document.getElementById('goal-progress-fill').style.width = percent + "%";
        document.getElementById('reset-month-btn').style.display = state.currentTab === 'monthly' ? 'block' : 'none';

        if (totalOverall >= 5000 && !hasCelebrated) { triggerCelebration(); }
    }

    function triggerCelebration() {
        hasCelebrated = true;
        document.getElementById('celebration-overlay').style.display = 'flex';
        for (let i = 0; i < 15; i++) {
            setTimeout(() => {
                const b = document.createElement('div'); b.className = 'bubble';
                const size = Math.random() * 30 + 10;
                b.style.width = size + 'px'; b.style.height = size + 'px';
                b.style.left = Math.random() * 100 + '%';
                b.style.animationDuration = (Math.random() * 2 + 3) + 's';
                document.getElementById('celebration-overlay').appendChild(b);
            }, i * 250);
        }
    }

    function endMonthReset() {
        const actualTotal = state.p1.actualSavings + state.p2.actualSavings;
        if(!confirm(`Ready for a new month? This banks your actual $${actualTotal} savings and resets your sliders.`)) return;
        state.baseSavings += actualTotal;
        document.getElementById('base-savings').value = Math.round(state.baseSavings);
        state.p1.actualSavings = 0; state.p2.actualSavings = 0;
        Object.keys(state.p1.expenses).forEach(k => state.p1.expenses[k].val = state.p1.expenses[k].goal);
        Object.keys(state.p2.expenses).forEach(k => state.p2.expenses[k].val = state.p2.expenses[k].goal);
        save(); render();
    }

    function render() {
        const container = document.getElementById('category-container');
        container.innerHTML = '';
        if (state.currentTab === 'monthly') {
            document.getElementById('income-input').value = state.p1.income + state.p2.income;
            Object.keys(state.p1.expenses).forEach(k => {
                const total = state.p1.expenses[k].val + state.p2.expenses[k].val;
                container.innerHTML += `<div class="card"><div class="card-header"><span class="card-title">${state.p1.expenses[k].label}</span><span style="font-weight:700;font-size:24px;">$${Math.round(total)}</span></div></div>`;
            });
        } else {
            document.getElementById('income-input').value = state[state.currentTab].income;
            Object.entries(state[state.currentTab].expenses).forEach(([k, d]) => {
                const diff = d.val - d.goal;
                container.innerHTML += `<div class="card"><div class="card-header"><div class="card-title-group"><span class="card-title">${d.label}</span><div id="pill-${k}" class="pill ${diff>0?'red':(diff<0?'green':'neutral')}">${diff==0?'On Target':(diff>0?'+$'+Math.round(diff)+' Over':'-$'+Math.round(Math.abs(diff))+' Under')}</div></div><span style="font-weight:700;font-size:24px;" id="amt-${k}">$${Math.round(d.val)}</span></div><input type="range" id="slider-${k}" min="0" max="${d.max}" value="${d.val}" oninput="updateExp('${k}', this.value)"></div>`;
                setTimeout(() => updateSliderFill(document.getElementById(`slider-${k}`), d.type), 10);
            });
        }
        calculateFinals();
    }

    function updateSliderFill(s, type) { if(!s) return; const pct = (s.value - s.min) / (s.max - s.min) * 100; let c = type === 'bill' ? '#F2B8B5' : (type === 'giving' ? '#FFD54F' : '#D0BCFF'); s.style.background = `linear-gradient(to right, ${c} ${pct}%, #35323a ${pct}%)`; }
    function save() { localStorage.setItem('budgetShark_V1', JSON.stringify(state)); }
    init();
</script>
</body>
</html>
